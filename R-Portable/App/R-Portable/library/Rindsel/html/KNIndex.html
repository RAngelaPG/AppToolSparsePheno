<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Restrictive Kempthorne &amp; Nordskog selection index</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for KNIndex {Rindsel}"><tr><td>KNIndex {Rindsel}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Restrictive Kempthorne &amp; Nordskog selection index</h2>

<h3>Description</h3>

<p>Funtion for the restrictive Kempthorne &amp; Nordskog selection index</p>


<h3>Usage</h3>

<pre>
KNIndex(file.dat = NULL, weights = NULL, selval = 5, design = "lattice", 
corr = FALSE, out = "out.txt", outcsv = "out.csv", rawdata = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>file.dat</code></td>
<td>
<p>Text file in comma separated values (*.csv) foat which contains the traits (columns) for entries (rows).</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>Text file in comma separated values (*.csv) foat whose columns are: names of the traits, indicator variable for selected traits, economic weights or signs of the traits and indicator variable for restricted traits. If no name of the file is given, the file is choosen interactively.</p>
</td></tr>
<tr valign="top"><td><code>selval</code></td>
<td>
<p>Percent of selected genotypes (5, 10, 20). Default is selval=5.</p>
</td></tr> 
<tr valign="top"><td><code>design</code></td>
<td>
<p>Field design (&quot;lattice&quot;, &quot;rcb&quot;). Default is design=&quot;lattice&quot;.</p>
</td></tr>
<tr valign="top"><td><code>corr</code></td>
<td>
<p>Selection index is based on variances-covariances matrix (FALSE) or correlation matrix (TRUE). Default is corr=FALSE.</p>
</td></tr>
<tr valign="top"><td><code>out</code></td>
<td>
<p>Output file name. Default is out=&quot;out.txt&quot;.</p>
</td></tr>
<tr valign="top"><td><code>outcsv</code></td>
<td>
<p>Output file in foat *.csv. Default is outcsv=&quot;outcsv.csv&quot;. The file named &quot;alloutcsv.csv&quot; is generated, which contains the values of the traits and the KN selection index for all the individuals.</p>
</td></tr>
<tr valign="top"><td><code>rawdata</code></td>
<td>
<p>If genotypic and photypic variances are already calculated, then it can be used to calculate directly the index by setting rawdat=TRUE. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kempthorne and Nordskog (1959) proposed an index that incorporates 
restrictions based on a predeteined level and improvement 
developed the theory of restricted selection index 
(ISR), which maximizes the genetic progress of some average 
Phenotypic variables while the other half is maintained without 
exchange. According to Cunningham et al.  (1970), it is considered that an IS is 
restricted if the average allows one or more variables 
phenotype remains unchanged (no genetic gain) while 
in other genetic gain is maximized average. In general, the 
Kempthorne and Nordskog ISR (1959) has similar properties to IS 
Smith (1936). 
</p>
<p>Consider the problem of increasing grain yield in 
corn while other phenotypic variables remain without 
exchange. In this situation Kempthorne and Nordskog (1959) (KN) proposed 
maximize <i>&rho;_{YZ}^2</i>  incorporating constraints matrix 
genotypic variance-covariance. Bulmer (1980) showed that 
Kempthorne and Nordskog results (1959) also obtained 
maximize <i> {&theta;}'G &beta; </i> . In the derivation of the ISR 
Kempthorne and Nordskog (1959) follows the approach of Bulmer (1980). 
</p>
<p>Suppose we have <i>q</i> variables and desired phenotypic 
improve the average of <i>qr</i> of them while <i> r </i> of them remain without 
average exchange, the index <i>Y=&beta;'p </i> must maximize 
<i>&rho;_{YZ} ^ 2 </i> under such conditions. The restrictions are introduced by 
through the matrix <i> W </i> of 0s and 1s, where 1s indicate that 
mean values of the variables remain unchanged, while the 
0s indicate average changes in phenotypic variables, such 
so that <i> W'G &beta; =0 </i> . Let <i>  C =GW </i> , since <i> &rho;_{YZ} </i> is invariant under changes of scale, can 
assume that <i> &beta; 'P &beta; = 1 </i> , so <i> &theta; 'G &beta; </i> should be maximized under the 
constraint <i>&beta;'C = 0</i> and <i>&beta;' P &beta; = 1 </i> . Let <i> &tau; </i> and 
<i> v'=&le;ft [{v_1 ... v_r} \right] </i> Lagrange multipliers. 
Should be maximized 
</p>
<p style="text-align: center;"><i> 
&Psi; =&theta;'G &beta; - &tau;  (&beta;'P &beta;-1) -v 'C' &beta;</i></p>
  
<p>In deriving <i> &Psi; </i> over <i> &beta; </i> and equate the result to 
null vector is 
</p>
<p style="text-align: center;"><i> 
&theta;'G-2 &tau; P &beta; -v'C' =0 
</i></p>
 
<p>Thus, the vector of coefficients of KN that maximizes <i> &rho;_{YZ}^2 </i> is 
<i> &beta;_{KN}=[I -P^{-1}C (C'P^{-1}C)^{-1}C']&beta;_S </i> , where <i>P^{-1} </i> 
is the inverse matrix <i>P</i> and <i>&beta;_S </i> is the vector defined in Equation 3 (the 
subscript denotes Kempthorne and Nordskog KN). If <i> A=[ I - P^{-1} C(C'P ^{-1}C)^{-1}C'] </i> , then 
</p>
<p style="text-align: center;"><i> 
 &beta;_{KN} =A &beta;_S.  
</i></p>



<h3>Value</h3>

<p>The KN selection index and an output file which contains the selected entries and other useful infoation.
</p>


<h3>Examples</h3>

<pre>

#library(Rindsel)
#data(TRAIT_GSI)
#data(WEIGHTS_GSI)
#KNIndex(file.dat = TRAIT_GSI,weights=WEIGHTS_GSI)
#T
</pre>

<hr /><div style="text-align: center;">[Package <em>Rindsel</em> version 1.3 <a href="00Index.html">Index</a>]</div>
</body></html>
